<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="æ·±å…¥å­¦ä¹ ," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å…¥é—¨è¿™é‡Œåªè¯´æµè§ˆå™¨ç¯å¢ƒä¸‹,åœ¨ä¸åŒæµè§ˆå™¨ä¸‹è¡¨ç°ä¸åŒï¼Œè¿™é‡Œæ˜¯åœ¨chrome!!!! å‚è€ƒèµ„æ–™         https://www.codercto.com/a/18956.html https://github.com/aooy/blog/issues/5 â€‹             è¿™ä¸ªåœ°å€ï¼Œå¯ä»¥çœ‹åˆ°å…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œè¿˜æœ‰è¯¦ç»†çš„æ•™ç¨‹ï¼Œä¸­æ–‡å­—å¹•å“ˆå“ˆå“ˆå“ˆ  1.å•çº¿ç¨‹çš„">
<meta name="keywords" content="æ·±å…¥å­¦ä¹ ">
<meta property="og:type" content="article">
<meta property="og:title" content="äº‹ä»¶å¾ªç¯">
<meta property="og:url" content="http://yoursite.com/2018/12/20/åˆè¯†macrotaskå’Œmicrotask/index.html">
<meta property="og:site_name" content="æ¸£æ¸£å¤§æ˜Ÿæ˜Ÿçš„å­¦ä¹ ç¬”è®°">
<meta property="og:description" content="äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å…¥é—¨è¿™é‡Œåªè¯´æµè§ˆå™¨ç¯å¢ƒä¸‹,åœ¨ä¸åŒæµè§ˆå™¨ä¸‹è¡¨ç°ä¸åŒï¼Œè¿™é‡Œæ˜¯åœ¨chrome!!!! å‚è€ƒèµ„æ–™         https://www.codercto.com/a/18956.html https://github.com/aooy/blog/issues/5 â€‹             è¿™ä¸ªåœ°å€ï¼Œå¯ä»¥çœ‹åˆ°å…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œè¿˜æœ‰è¯¦ç»†çš„æ•™ç¨‹ï¼Œä¸­æ–‡å­—å¹•å“ˆå“ˆå“ˆå“ˆ  1.å•çº¿ç¨‹çš„">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://www.qinhanwen.xyz/images/WX20181224-231326@2x.png">
<meta property="og:image" content="http://www.qinhanwen.xyz/images/WX20181224-232444@2x.png">
<meta property="og:image" content="http://www.qinhanwen.xyz/images/event-loop.gif">
<meta property="og:image" content="http://www.qinhanwen.xyz/images/WX20181225-202805@2x.png">
<meta property="og:updated_time" content="2019-01-27T12:54:27.049Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="äº‹ä»¶å¾ªç¯">
<meta name="twitter:description" content="äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å…¥é—¨è¿™é‡Œåªè¯´æµè§ˆå™¨ç¯å¢ƒä¸‹,åœ¨ä¸åŒæµè§ˆå™¨ä¸‹è¡¨ç°ä¸åŒï¼Œè¿™é‡Œæ˜¯åœ¨chrome!!!! å‚è€ƒèµ„æ–™         https://www.codercto.com/a/18956.html https://github.com/aooy/blog/issues/5 â€‹             è¿™ä¸ªåœ°å€ï¼Œå¯ä»¥çœ‹åˆ°å…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œè¿˜æœ‰è¯¦ç»†çš„æ•™ç¨‹ï¼Œä¸­æ–‡å­—å¹•å“ˆå“ˆå“ˆå“ˆ  1.å•çº¿ç¨‹çš„">
<meta name="twitter:image" content="http://www.qinhanwen.xyz/images/WX20181224-231326@2x.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/12/20/åˆè¯†macrotaskå’Œmicrotask/"/>





  <title>äº‹ä»¶å¾ªç¯ | æ¸£æ¸£å¤§æ˜Ÿæ˜Ÿçš„å­¦ä¹ ç¬”è®°</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">æ¸£æ¸£å¤§æ˜Ÿæ˜Ÿçš„å­¦ä¹ ç¬”è®°</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/index.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/index.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/index.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/20/åˆè¯†macrotaskå’Œmicrotask/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ç§¦ç€šæ–‡">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ¸£æ¸£å¤§æ˜Ÿæ˜Ÿçš„å­¦ä¹ ç¬”è®°">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">äº‹ä»¶å¾ªç¯</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-20T18:44:49+08:00">
                2018-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/æ·±å…¥å­¦ä¹ /" itemprop="url" rel="index">
                    <span itemprop="name">æ·±å…¥å­¦ä¹ </span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="äº‹ä»¶å¾ªç¯ï¼ˆEvent-Loopï¼‰å…¥é—¨"><a href="#äº‹ä»¶å¾ªç¯ï¼ˆEvent-Loopï¼‰å…¥é—¨" class="headerlink" title="äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å…¥é—¨"></a>äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å…¥é—¨</h1><h3 id="è¿™é‡Œåªè¯´æµè§ˆå™¨ç¯å¢ƒä¸‹-åœ¨ä¸åŒæµè§ˆå™¨ä¸‹è¡¨ç°ä¸åŒï¼Œè¿™é‡Œæ˜¯åœ¨chrome"><a href="#è¿™é‡Œåªè¯´æµè§ˆå™¨ç¯å¢ƒä¸‹-åœ¨ä¸åŒæµè§ˆå™¨ä¸‹è¡¨ç°ä¸åŒï¼Œè¿™é‡Œæ˜¯åœ¨chrome" class="headerlink" title="è¿™é‡Œåªè¯´æµè§ˆå™¨ç¯å¢ƒä¸‹,åœ¨ä¸åŒæµè§ˆå™¨ä¸‹è¡¨ç°ä¸åŒï¼Œè¿™é‡Œæ˜¯åœ¨chrome!!!!"></a>è¿™é‡Œåªè¯´æµè§ˆå™¨ç¯å¢ƒä¸‹,åœ¨ä¸åŒæµè§ˆå™¨ä¸‹è¡¨ç°ä¸åŒï¼Œè¿™é‡Œæ˜¯åœ¨<strong>chrome!!!!</strong></h3><blockquote>
<p>å‚è€ƒèµ„æ–™         <a href="https://www.codercto.com/a/18956.html" target="_blank" rel="noopener">https://www.codercto.com/a/18956.html</a></p>
<pre><code>https://github.com/aooy/blog/issues/5
</code></pre><p>â€‹             <a href="http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D" target="_blank" rel="noopener">è¿™ä¸ªåœ°å€ï¼Œå¯ä»¥çœ‹åˆ°å…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œè¿˜æœ‰è¯¦ç»†çš„æ•™ç¨‹ï¼Œä¸­æ–‡å­—å¹•å“ˆå“ˆå“ˆå“ˆ</a></p>
</blockquote>
<h4 id="1-å•çº¿ç¨‹çš„JavaScript"><a href="#1-å•çº¿ç¨‹çš„JavaScript" class="headerlink" title="1.å•çº¿ç¨‹çš„JavaScript"></a>1.å•çº¿ç¨‹çš„JavaScript</h4><p>è´Ÿè´£è§£æå’Œæ‰§è¡ŒJavaScriptçš„çº¿ç¨‹åªæœ‰ä¸€ä¸ªï¼ŒåŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œä¸€æ®µJavaScriptä»£ç ã€‚JavaScriptè®¾è®¡çš„æ—¶å€™å°±æ˜¯ä¸€ç§æµè§ˆå™¨è„šæœ¬ï¼Œè´Ÿè´£ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ï¼Œä¸»è¦ç”¨æ¥æ“ä½œDOMï¼Œå¦‚æœæ˜¯å¤šçº¿ç¨‹çš„ï¼ŒåŒæ—¶æ“ä½œåŒä¸ªDOMå°±ä¸åˆé€‚äº†ã€‚</p>
<h4 id="2-è°ƒç”¨æ ˆï¼ˆcall-stackï¼‰"><a href="#2-è°ƒç”¨æ ˆï¼ˆcall-stackï¼‰" class="headerlink" title="2.è°ƒç”¨æ ˆï¼ˆcall stackï¼‰"></a>2.<a href="https://medium.freecodecamp.org/understanding-the-javascript-call-stack-861e41ae61d4" target="_blank" rel="noopener">è°ƒç”¨æ ˆ</a>ï¼ˆcall stackï¼‰</h4><p>å½“è°ƒç”¨å‡½æ•°æ—¶ï¼Œå…¶å‚æ•°å’Œå˜é‡è¢«æ¨å…¥è°ƒç”¨å †æ ˆä»¥å½¢æˆå †æ ˆå¸§ã€‚ æ­¤å †æ ˆå¸§æ˜¯å †æ ˆä¸­çš„å†…å­˜ä½ç½®ã€‚æœ€åä¸€ä¸ªè¢«æ¨å…¥å †æ ˆçš„å‡½æ•°æ˜¯ç¬¬ä¸€ä¸ªè¢«å¼¹å‡ºçš„å‡½æ•°ï¼Œ å½“æ‰€æœ‰å‡½æ•°ä»å †æ ˆä¸­å¼¹å‡ºæ—¶ï¼Œå†…å­˜è¢«æ¸…é™¤ã€‚</p>
<p><img src="http://www.qinhanwen.xyz/images/WX20181224-231326@2x.png" alt=""></p>
<h6 id="ä¸¾ä¸ªğŸŒ°ï¼Œæ‰§è¡Œæ ˆæ˜¯æ€æ ·å¤„ç†å‡½æ•°è°ƒç”¨çš„ï¼š"><a href="#ä¸¾ä¸ªğŸŒ°ï¼Œæ‰§è¡Œæ ˆæ˜¯æ€æ ·å¤„ç†å‡½æ•°è°ƒç”¨çš„ï¼š" class="headerlink" title="ä¸¾ä¸ªğŸŒ°ï¼Œæ‰§è¡Œæ ˆæ˜¯æ€æ ·å¤„ç†å‡½æ•°è°ƒç”¨çš„ï¼š"></a>ä¸¾ä¸ªğŸŒ°ï¼Œæ‰§è¡Œæ ˆæ˜¯æ€æ ·å¤„ç†å‡½æ•°è°ƒç”¨çš„ï¼š</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">firstFunction</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"Hello from firstFunction"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">secondFunction</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> firstFunction();</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"The end from secondFunction"</span>);</span><br><span class="line">&#125;</span><br><span class="line">secondFunction();</span><br></pre></td></tr></table></figure>
<p>1ï¼‰æ‰§è¡ŒsecondFunctionè°ƒç”¨ï¼Œåˆ›å»ºä¸€ä¸ªæ‰§è¡Œæ ˆï¼Œå¹¶ä¸”å‹å…¥æ ˆã€‚</p>
<p>2ï¼‰ä¹‹åfirstFunctionè¢«è°ƒç”¨ï¼ŒfirstFunctionè¢«å‹å…¥æ‰§è¡Œæ ˆä¸­ã€‚</p>
<p>3ï¼‰è¿”å›æ‰“å°å‡º Hello from firstFunctionä¹‹åï¼Œ firstFunction è¢«å¼¹å‡ºæ ˆã€‚</p>
<p>4ï¼‰è¿”å›æ‰“å° The end from secondFunctionä¹‹åï¼ŒsecondFunctionè¢«å¼¹å‡ºæ ˆï¼Œæ¸…é™¤å†…å­˜ã€‚</p>
<h4 id="3-webapis"><a href="#3-webapis" class="headerlink" title="3.webapis"></a>3.webapis</h4><p>æ˜¯ä¸€ç§æµè§ˆå™¨æä¾›ç»™æˆ‘ä»¬çš„apiï¼Œä¸åœ¨v8å¼•æ“ä¸­</p>
<h4 id="4-ä»»åŠ¡é˜Ÿåˆ—"><a href="#4-ä»»åŠ¡é˜Ÿåˆ—" class="headerlink" title="4.ä»»åŠ¡é˜Ÿåˆ—"></a>4.ä»»åŠ¡é˜Ÿåˆ—</h4><p><img src="http://www.qinhanwen.xyz/images/WX20181224-232444@2x.png" alt=""></p>
<h5 id="1ï¼‰ä»»åŠ¡åˆ†ä¸ºä¸¤ç§ï¼š"><a href="#1ï¼‰ä»»åŠ¡åˆ†ä¸ºä¸¤ç§ï¼š" class="headerlink" title="1ï¼‰ä»»åŠ¡åˆ†ä¸ºä¸¤ç§ï¼š"></a>1ï¼‰ä»»åŠ¡åˆ†ä¸ºä¸¤ç§ï¼š</h5><p>åŒæ­¥ä»»åŠ¡ï¼šåŒæ­¥ä»»åŠ¡åœ¨ä¸»çº¿ç¨‹ä¸­æ’é˜Ÿæ‰§è¡Œçš„ä»»åŠ¡ã€‚</p>
<p>å¼‚æ­¥ä»»åŠ¡ï¼šå¼‚æ­¥ä»»åŠ¡ä¸è¿›å…¥ä¸»çº¿ç¨‹ï¼Œå¼‚æ­¥ä»»åŠ¡æœ‰ç»“æœçš„åå°†å…·ä½“ä»»åŠ¡æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼ˆtask queueï¼‰ã€‚åªæœ‰â€ä»»åŠ¡é˜Ÿåˆ—â€é€šçŸ¥ä¸»çº¿ç¨‹ï¼ŒæŸä¸ªå¼‚æ­¥ä»»åŠ¡å¯ä»¥æ‰§è¡Œäº†ï¼Œè¯¥ä»»åŠ¡æ‰ä¼šè¿›å…¥ä¸»çº¿ç¨‹æ‰§è¡Œã€‚</p>
<h5 id="2ï¼‰è¿è¡Œæœºåˆ¶ï¼ˆæˆ‘çš„ç†è§£ï¼‰"><a href="#2ï¼‰è¿è¡Œæœºåˆ¶ï¼ˆæˆ‘çš„ç†è§£ï¼‰" class="headerlink" title="2ï¼‰è¿è¡Œæœºåˆ¶ï¼ˆæˆ‘çš„ç†è§£ï¼‰"></a>2ï¼‰è¿è¡Œæœºåˆ¶ï¼ˆæˆ‘çš„ç†è§£ï¼‰</h5><p>1.åŒæ­¥ä»»åŠ¡åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œå½¢æˆä¸€ä¸ª<code>æ‰§è¡Œæ ˆ</code>ã€‚</p>
<p>2.å¼‚æ­¥ä»»åŠ¡ï¼Œæœ‰ç»“æœçš„æ—¶å€™ï¼Œå°†å…·ä½“ä»»åŠ¡æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ã€‚</p>
<p>3.ä¸»çº¿ç¨‹ä¸­æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œå°±ä¼šä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ‰§è¡Œã€‚</p>
<p>4.ä¸»çº¿ç¨‹ä¸æ–­é‡å¤ä¸Šé¢æ­¥éª¤ã€‚</p>
<h5 id="3ï¼‰ä»»åŠ¡é˜Ÿåˆ—åˆ†ç±»"><a href="#3ï¼‰ä»»åŠ¡é˜Ÿåˆ—åˆ†ç±»" class="headerlink" title="3ï¼‰ä»»åŠ¡é˜Ÿåˆ—åˆ†ç±»"></a>3ï¼‰ä»»åŠ¡é˜Ÿåˆ—åˆ†ç±»</h5><p>1.macro-taskï¼ˆå®ä»»åŠ¡ï¼‰ï¼šscriptï¼ˆæ•´ä½“ä»£ç )ï¼ŒsetTimeoutï¼ŒsetIntervalï¼ŒI/Oï¼ŒUI Rendering</p>
<p>2.micro-taskï¼ˆå¾®ä»»åŠ¡ï¼‰ï¼šPromiseï¼Œ<a href="https://qinhanwen.github.io/2018/11/23/VDOM-%E5%92%8C-render/" target="_blank" rel="noopener">MutationObserver</a></p>
<h5 id="ä¸¾ä¸ªğŸŒ°ï¼Œé—®è¾“å‡ºé¡ºåº"><a href="#ä¸¾ä¸ªğŸŒ°ï¼Œé—®è¾“å‡ºé¡ºåº" class="headerlink" title="ä¸¾ä¸ªğŸŒ°ï¼Œé—®è¾“å‡ºé¡ºåº"></a>ä¸¾ä¸ªğŸŒ°ï¼Œé—®è¾“å‡ºé¡ºåº</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">    resolve();</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">5</span>)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">6</span>);</span><br><span class="line"><span class="comment">//1 3 4 6 5 2</span></span><br></pre></td></tr></table></figure>
<p>ï¼ˆpsï¼šè¿™é‡Œé¡ºåºåŠ å…¥äº†ä¸€ä¸ªsetTImeoutç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå› ä¸ºä¼ å…¥çš„æ˜¯ä¸€ä¸ªå‡½æ•°ç«‹å³è°ƒç”¨ï¼Œæ‰€ä»¥è§†ä¸º<code>setTimeout(undefined,...)</code>ï¼‰</p>
<p>1ï¼‰é¦–å…ˆconsole.log(1),å‹å…¥æ‰§è¡Œæ ˆï¼Œæ‰“å°å‡º1ï¼Œå°†å®ƒå¼¹å‡ºæ‰§è¡Œæ ˆã€‚</p>
<p>2ï¼‰å‘ç°<code>setTimeout</code>ï¼Œå‹å…¥æ‰§è¡Œæ ˆï¼Œæ‰§è¡Œ<code>setTimeout</code>ï¼Œæ‰§è¡Œçš„æ—¶å€™ï¼Œå°†å®ƒæ”¾å…¥ <code>webapis</code>ç­‰å¾…ç»“æœï¼Œå¹¶ä¸”æŠŠ<code>setTimeout</code>å¼¹å‡ºæ‰§è¡Œæ ˆï¼Œ0ç§’åæœ‰ç»“æœäº†å°†å…·ä½“çš„ä»»åŠ¡ï¼ˆå›è°ƒï¼‰æ”¾å…¥Macro-task</p>
<p>3ï¼‰æ¥ç€console.log(3)å‹å…¥æ‰§è¡Œæ ˆï¼Œæ‰“å°å‡º3ï¼Œå¼¹å‡ºæ‰§è¡Œæ ˆ</p>
<p>4ï¼‰æ•´ä¸ªnew Promiseè°ƒç”¨è¢«å‹å…¥æ ˆï¼Œ console.log(4)å‹å…¥æ ˆï¼Œæ‰“å°å‡º4ï¼Œconsole.log(4)å¼¹å‡ºæ ˆï¼Œä¹‹åresolve()å…¥æ ˆï¼Œæ‰§è¡Œå®Œä¹‹åresolve()å¼¹å‡ºæ ˆï¼Œthenæ–¹æ³•é‡Œçš„å…·ä½“ä»»åŠ¡æ”¾å…¥Micro-taskï¼Œ</p>
<p>5ï¼‰console.log(6)å‹å…¥æ ˆï¼Œæ‰“å°å‡º6ï¼Œå¼¹å‡ºæ ˆ</p>
<p>6ï¼‰ä¸»çº¿ç¨‹ï¼ˆå½“å‰çš„åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œäº†ï¼‰ï¼Œç«‹åˆ»æ‰§è¡ŒMicro-taskä¸­çš„ä»»åŠ¡ï¼Œconsole.log(5)å‹å…¥æ ˆï¼Œæ‰“å°5,æ‰§è¡Œå®Œå¼¹å‡ºæ ˆ</p>
<p>7ï¼‰ä¸»çº¿ç¨‹ï¼ˆå½“å‰çš„åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œäº†ï¼‰å¹¶ä¸”Micro-taskä¸­æ— ä»»åŠ¡ï¼Œä»Macro-taskä¸­å–ä»»åŠ¡ï¼Œconsole.log(2)å‹å…¥æ ˆï¼Œæ‰“å°2ã€‚æ‰§è¡Œå®Œå¼¹å‡ºæ ˆ</p>
<h5 id="æ„Ÿè§‰æ–‡å­—å¤ªå¤šå°±å˜å¥½å¥½å¤æ‚ï¼Œçœ‹å›¾"><a href="#æ„Ÿè§‰æ–‡å­—å¤ªå¤šå°±å˜å¥½å¥½å¤æ‚ï¼Œçœ‹å›¾" class="headerlink" title="æ„Ÿè§‰æ–‡å­—å¤ªå¤šå°±å˜å¥½å¥½å¤æ‚ï¼Œçœ‹å›¾"></a>æ„Ÿè§‰æ–‡å­—å¤ªå¤šå°±å˜å¥½å¥½å¤æ‚ï¼Œçœ‹å›¾</h5><p><img src="http://www.qinhanwen.xyz/images/event-loop.gif" alt=""></p>
<p>å¦‚æœå†™äº†ä¸€ä¸ªæ­»å¾ªç¯ï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹ä¸ç©ºçš„æ—¶å€™ï¼Œæ°¸è¿œä¸ä¼šæ‰§è¡ŒMacro-taskå’ŒMicro-taské‡Œçš„ä»»åŠ¡</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'ä¸è¾“å‡º'</span>)</span><br><span class="line">&#125;,<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">1</span>;i--)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ­»å¾ªç¯'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æˆ‘è¿è¡Œäº†ä¸€ä¸‹é£æ‰‡ç‹‚é£™ç„¶åé‡å¯ç”µè„‘ã€‚ã€‚ã€‚è¦è°¨æ…å°è¯•</span></span><br></pre></td></tr></table></figure>
<h5 id="ç¬¬äºŒä¸ªğŸŒ°ï¼Œå…¶å®å†™åˆ°è¿™çš„æ—¶å€™ï¼Œæˆ‘è§‰å¾—æˆ‘å·²ç»å¯¹äº‹ä»¶å¾ªç¯äº†å¦‚æŒ‡æŒäº†ï¼Œç„¶é¹…æˆ‘åˆçœ‹åˆ°äº†è¿™æ ·çš„ä¸€é“é¢˜"><a href="#ç¬¬äºŒä¸ªğŸŒ°ï¼Œå…¶å®å†™åˆ°è¿™çš„æ—¶å€™ï¼Œæˆ‘è§‰å¾—æˆ‘å·²ç»å¯¹äº‹ä»¶å¾ªç¯äº†å¦‚æŒ‡æŒäº†ï¼Œç„¶é¹…æˆ‘åˆçœ‹åˆ°äº†è¿™æ ·çš„ä¸€é“é¢˜" class="headerlink" title="ç¬¬äºŒä¸ªğŸŒ°ï¼Œå…¶å®å†™åˆ°è¿™çš„æ—¶å€™ï¼Œæˆ‘è§‰å¾—æˆ‘å·²ç»å¯¹äº‹ä»¶å¾ªç¯äº†å¦‚æŒ‡æŒäº†ï¼Œç„¶é¹…æˆ‘åˆçœ‹åˆ°äº†è¿™æ ·çš„ä¸€é“é¢˜"></a>ç¬¬äºŒä¸ªğŸŒ°ï¼Œå…¶å®å†™åˆ°è¿™çš„æ—¶å€™ï¼Œæˆ‘è§‰å¾—æˆ‘å·²ç»å¯¹äº‹ä»¶å¾ªç¯äº†å¦‚æŒ‡æŒäº†ï¼Œç„¶é¹…æˆ‘åˆçœ‹åˆ°äº†è¿™æ ·çš„ä¸€é“é¢˜</h5><p><img src="http://www.qinhanwen.xyz/images/WX20181225-202805@2x.png" alt="WX20181225-200839@2x"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.outer</span>&#123;</span></span><br><span class="line"><span class="undefined">    width: 200px;</span></span><br><span class="line"><span class="undefined">    height: 200px;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#ddd</span>;</span></span><br><span class="line"><span class="undefined">    position: relative;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.inner</span>&#123;</span></span><br><span class="line"><span class="undefined">    width: 150px;</span></span><br><span class="line"><span class="undefined">    height: 150px;</span></span><br><span class="line"><span class="undefined">    position: absolute;</span></span><br><span class="line"><span class="undefined">    left: 50%;</span></span><br><span class="line"><span class="undefined">    top: 50%;</span></span><br><span class="line"><span class="undefined">    margin: -75px 0 0 -75px;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#eee</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"outer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> outer = <span class="built_in">document</span>.querySelector(<span class="string">'.outer'</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> inner = <span class="built_in">document</span>.querySelector(<span class="string">'.inner'</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">new</span> MutationObserver(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">'mutate'</span>);</span></span><br><span class="line"><span class="undefined">    &#125;).observe(outer, &#123;</span></span><br><span class="line"><span class="javascript">        attributes: <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">onClick</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">'click'</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'timeout'</span>);</span></span><br><span class="line"><span class="undefined">        &#125;, 0);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'promise'</span>);</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        outer.setAttribute(<span class="string">'data-random'</span>, <span class="built_in">Math</span>.random());</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    inner.addEventListener(<span class="string">'click'</span>, onClick);</span></span><br><span class="line"><span class="javascript">    outer.addEventListener(<span class="string">'click'</span>, onClick);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ‰“å°ç»“æœ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//click</span></span><br><span class="line"><span class="comment">//promise</span></span><br><span class="line"><span class="comment">//mutate</span></span><br><span class="line"><span class="comment">//click</span></span><br><span class="line"><span class="comment">//promise</span></span><br><span class="line"><span class="comment">//mutate</span></span><br><span class="line"><span class="comment">//timeout</span></span><br><span class="line"><span class="comment">//timeout</span></span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆç‚¹å‡»çš„æ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆï¼ˆæ²¡å†™è°ƒç”¨è¿›æ ˆå‡ºæ ˆçš„éƒ¨åˆ†ï¼‰</p>
<p>1ï¼‰innerçš„ç›‘å¬äº‹ä»¶è§¦å‘ï¼Œè§¦å‘çš„å‡½æ•°æ‰§è¡Œï¼Œå°†å‡½æ•°å‹å…¥æ‰§è¡Œæ ˆ</p>
<p>2ï¼‰æ‰“å°<code>click</code></p>
<p>3ï¼‰setTImeoutæ˜¯webApisï¼Œå°†æ–¹æ³•é‡Œçš„å…·ä½“ä»»åŠ¡æ”¾å…¥<strong>Macro-task</strong></p>
<p>4ï¼‰.thené‡Œçš„å…·ä½“ä»»åŠ¡æ”¾å…¥<strong>Micro-task</strong></p>
<p>5ï¼‰outer.setAttributeè§¦å‘MutationObserverï¼Œå°†å…·ä½“çš„ä»»åŠ¡æ”¾å…¥<strong>Micro-task</strong></p>
<p>6ï¼‰è¿™æ—¶å€™innerç›‘å¬äº‹ä»¶çš„å‡½æ•°æ‰§è¡Œå®Œï¼Œè¢«å¼¹å‡ºæ‰§è¡Œæ ˆ</p>
<p>7ï¼‰ä¸»çº¿ç¨‹ï¼ˆå½“å‰çš„åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œäº†ï¼‰ï¼Œæ‰§è¡Œ<strong>Micro-task</strong>ä»»åŠ¡</p>
<p>8ï¼‰<strong>Micro-task</strong>ä»»åŠ¡è¢«æ‰§è¡Œï¼Œå…ˆæ‰“å°<code>promise</code>ï¼Œå†æ‰“å°<code>mutate</code></p>
<p>9ï¼‰ä¸»çº¿ç¨‹ï¼ˆå½“å‰çš„åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œäº†ï¼‰ï¼Œ<strong>Micro-task</strong>ä»»åŠ¡é˜Ÿåˆ—ç©ºäº†ï¼Œè¿™æ—¶å€™å¹¶æ²¡æœ‰æ‰§è¡Œ<strong>Macro-task</strong>é‡Œçš„ä»»åŠ¡ï¼ï¼ï¼å› ä¸ºè¿™æ—¶å€™å†’æ³¡è¢«è§¦å‘äº†ï¼Œå¯¼è‡´outerçš„ç›‘å¬äº‹ä»¶è¢«è§¦å‘</p>
<p>10ï¼‰é‡å¤ 2ï¼‰ï½ 8ï¼‰</p>
<p>11ï¼‰ä¸»çº¿ç¨‹ï¼ˆå½“å‰çš„åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œäº†ï¼‰ï¼Œ<strong>Micro-task</strong>ä»»åŠ¡é˜Ÿåˆ—ç©ºäº†ï¼Œæ‰§è¡Œ<strong>Macro-task</strong>é‡Œçš„ä»»åŠ¡</p>
<p>12ï¼‰å…ˆæ‰“å°<code>timeout</code>ï¼Œå†æ‰“å°<code>timeout</code>ã€‚</p>
<blockquote>
<p>Execution of a Job can be initiated only when there is no running execution context and the execution context stack is emptyâ€¦  â€” ECMAScript: Jobs and Job Queues</p>
</blockquote>
<p>å…¶å®é‡è¦çš„æ˜¯ <strong>Micro-task</strong>ä»»åŠ¡çš„æ‰§è¡Œæ—¶æœºï¼Œä¸€æœ‰æœºä¼šç«‹é©¬æ‰§è¡Œï¼éå¸¸å‹¤åŠ³ï¼Œ<strong>Macro-task</strong>å¯èƒ½å°±æ¯”è¾ƒæ‡’äº†ã€‚</p>
<h5 id="ç¬¬ä¸‰ä¸ªğŸŒ°ï¼Œä¸€æ ·çš„ï¼Œå½“æˆ‘çœ‹å®Œè¿™é¢˜åæˆ‘è§‰å¾—æˆ‘åˆæ‡‚äº†ï¼Œç„¶åçœ‹ä¸‹ä¸€é¢˜"><a href="#ç¬¬ä¸‰ä¸ªğŸŒ°ï¼Œä¸€æ ·çš„ï¼Œå½“æˆ‘çœ‹å®Œè¿™é¢˜åæˆ‘è§‰å¾—æˆ‘åˆæ‡‚äº†ï¼Œç„¶åçœ‹ä¸‹ä¸€é¢˜" class="headerlink" title="ç¬¬ä¸‰ä¸ªğŸŒ°ï¼Œä¸€æ ·çš„ï¼Œå½“æˆ‘çœ‹å®Œè¿™é¢˜åæˆ‘è§‰å¾—æˆ‘åˆæ‡‚äº†ï¼Œç„¶åçœ‹ä¸‹ä¸€é¢˜"></a>ç¬¬ä¸‰ä¸ªğŸŒ°ï¼Œä¸€æ ·çš„ï¼Œå½“æˆ‘çœ‹å®Œè¿™é¢˜åæˆ‘è§‰å¾—æˆ‘åˆæ‡‚äº†ï¼Œç„¶åçœ‹ä¸‹ä¸€é¢˜</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å†ä¸Šä¸€ä¸ªé¢˜ç›®çš„åŸºç¡€ä¸Šåœ¨scriptæ ‡ç­¾çš„ç»“å°¾åŠ ä¸Š</span></span><br><span class="line">inner.click();</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰“å°ç»“æœ</span></span><br><span class="line"><span class="comment">//click</span></span><br><span class="line"><span class="comment">//click</span></span><br><span class="line"><span class="comment">//promise</span></span><br><span class="line"><span class="comment">//mutate</span></span><br><span class="line"><span class="comment">//promise</span></span><br><span class="line"><span class="comment">//timeout</span></span><br><span class="line"><span class="comment">//timeout</span></span><br></pre></td></tr></table></figure>
<p>å‘ç”Ÿäº†ä»€ä¹ˆã€‚ï¼ˆæ²¡å†™è°ƒç”¨è¿›æ ˆå‡ºæ ˆçš„éƒ¨åˆ†ï¼‰</p>
<p>é¦–å…ˆï¼Œè¿™ä¸ªä¸ä¸Šé¢æ‰§è¡Œçš„æƒ…å†µï¼Œæ˜¯å®ƒåœ¨scriptä¸­æ‰§è¡Œï¼Œè¿™ä¸ªå¾ˆé‡è¦</p>
<p>1ï¼‰æ‰§è¡Œæ ˆå‹å…¥scripté‡Œçš„æ•´ä½“</p>
<p>2ï¼‰inner.clickçš„onClickå‹å…¥æ ˆ</p>
<p>3ï¼‰æ‰“å°<code>click</code></p>
<p>4ï¼‰setTimeoutçš„å…·ä½“ä»»åŠ¡æ”¾å…¥<strong>Macro-task</strong></p>
<p>5ï¼‰.thenæ–¹æ³•é‡Œçš„å…·ä½“ä»»åŠ¡æ”¾å…¥<strong>Micro-task</strong></p>
<p>6ï¼‰outer.setAttributeè§¦å‘MutationObserverï¼Œå°†å…·ä½“çš„ä»»åŠ¡æ”¾å…¥<strong>Micro-task</strong></p>
<p>7ï¼‰è¿™æ—¶å€™å†’æ³¡è¢«è§¦å‘ï¼Œscriptä»ç„¶åœ¨ä¸»çº¿ç¨‹ä¸­ï¼Œæ²¡æœ‰è¢«å¼¹å‡ºæ ˆï¼Œç¬¬ä¸€ä¸ªonclickè°ƒç”¨è¢«å¼¹å‡ºæ ˆï¼Œç¬¬äºŒä¸ªouterçš„onclickè°ƒç”¨è¢«å‹å…¥æ ˆï¼ˆ<strong>Micro-task</strong>é‡Œçš„ä»»åŠ¡æ²¡åŠæ³•æ’å…¥æ‰§è¡Œï¼‰</p>
<p>8ï¼‰é‡å¤ 3ï¼‰ï½ 5ï¼‰</p>
<p>9ï¼‰ç¬¬äºŒæ¬¡æ²¡æœ‰å¢åŠ mutationï¼ˆMutationObserveræ¯”è¾ƒç‰¹åˆ«ï¼Œå¤šæ¬¡æ·»åŠ æˆ–è€…åˆ é™¤å­å…ƒç´ ä¹‹ç±»çš„æ“ä½œæˆ–è€…æ·»åŠ å±æ€§ç­‰ç­‰ï¼Œéƒ½åªä¼šè§¦å‘ä¸€æ¬¡å›è°ƒï¼‰</p>
<p>10ï¼‰ç„¶åouterçš„onclickè°ƒç”¨è¢«å¼¹å‡ºæ ˆï¼Œscriptä¹Ÿè¢«å¼¹å‡ºæ ˆ</p>
<p>11ï¼‰ä¸»çº¿ç¨‹ï¼ˆå½“å‰çš„åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œäº†ï¼‰ï¼Œæ‰§è¡Œ<strong>Micro-task</strong>ä»»åŠ¡ï¼Œå…ˆæ‰“å°promiseï¼Œå†æ‰“å°mutateï¼Œæ¥ç€æ‰“å°promise</p>
<p>12ï¼‰ä¸»çº¿ç¨‹ï¼ˆå½“å‰çš„åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œäº†ï¼‰ï¼Œ<strong>Micro-task</strong>ä»»åŠ¡é˜Ÿåˆ—ç©ºäº†ï¼Œæ‰§è¡Œ<strong>Macro-task</strong>é‡Œçš„ä»»åŠ¡</p>
<p>13ï¼‰å…ˆæ‰“å°<code>timeout</code>ï¼Œå†æ‰“å°<code>timeout</code>ã€‚</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>äº‹ä»¶å¾ªç¯ä¸æ­¢è¿™ä¹ˆä¸€ç‚¹ï¼Œè¿™ä¸€ç‚¹ä¹‹ä¸­å¯èƒ½ä¸ªäººç†è§£ä¼šæœ‰è¯¯ï¼Œå¦‚æœå‘ç°æœ‰ç†è§£é”™è¯¯å†å›æ¥æ”¹ã€‚</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/æ·±å…¥å­¦ä¹ /" rel="tag"># æ·±å…¥å­¦ä¹ </a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/12/15/ä¸ƒç‰›äº‘æµ‹è¯•åŸŸåè¿‡æœŸ/" rel="next" title="ä¸ƒç‰›äº‘æµ‹è¯•åŸŸåè¿‡æœŸ">
                <i class="fa fa-chevron-left"></i> ä¸ƒç‰›äº‘æµ‹è¯•åŸŸåè¿‡æœŸ
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/12/25/å›æµå’Œé‡ç»˜/" rel="prev" title="é‡æ’å’Œé‡ç»˜">
                é‡æ’å’Œé‡ç»˜ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="ç§¦ç€šæ–‡" />
          <p class="site-author-name" itemprop="name">ç§¦ç€šæ–‡</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/index.html">
                <span class="site-state-item-count">61</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#äº‹ä»¶å¾ªç¯ï¼ˆEvent-Loopï¼‰å…¥é—¨"><span class="nav-number">1.</span> <span class="nav-text">äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å…¥é—¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿™é‡Œåªè¯´æµè§ˆå™¨ç¯å¢ƒä¸‹-åœ¨ä¸åŒæµè§ˆå™¨ä¸‹è¡¨ç°ä¸åŒï¼Œè¿™é‡Œæ˜¯åœ¨chrome"><span class="nav-number">1.0.1.</span> <span class="nav-text">è¿™é‡Œåªè¯´æµè§ˆå™¨ç¯å¢ƒä¸‹,åœ¨ä¸åŒæµè§ˆå™¨ä¸‹è¡¨ç°ä¸åŒï¼Œè¿™é‡Œæ˜¯åœ¨chrome!!!!</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-å•çº¿ç¨‹çš„JavaScript"><span class="nav-number">1.0.1.1.</span> <span class="nav-text">1.å•çº¿ç¨‹çš„JavaScript</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-è°ƒç”¨æ ˆï¼ˆcall-stackï¼‰"><span class="nav-number">1.0.1.2.</span> <span class="nav-text">2.è°ƒç”¨æ ˆï¼ˆcall stackï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#ä¸¾ä¸ªğŸŒ°ï¼Œæ‰§è¡Œæ ˆæ˜¯æ€æ ·å¤„ç†å‡½æ•°è°ƒç”¨çš„ï¼š"><span class="nav-number">1.0.1.2.0.1.</span> <span class="nav-text">ä¸¾ä¸ªğŸŒ°ï¼Œæ‰§è¡Œæ ˆæ˜¯æ€æ ·å¤„ç†å‡½æ•°è°ƒç”¨çš„ï¼š</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-webapis"><span class="nav-number">1.0.1.3.</span> <span class="nav-text">3.webapis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-ä»»åŠ¡é˜Ÿåˆ—"><span class="nav-number">1.0.1.4.</span> <span class="nav-text">4.ä»»åŠ¡é˜Ÿåˆ—</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1ï¼‰ä»»åŠ¡åˆ†ä¸ºä¸¤ç§ï¼š"><span class="nav-number">1.0.1.4.1.</span> <span class="nav-text">1ï¼‰ä»»åŠ¡åˆ†ä¸ºä¸¤ç§ï¼š</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2ï¼‰è¿è¡Œæœºåˆ¶ï¼ˆæˆ‘çš„ç†è§£ï¼‰"><span class="nav-number">1.0.1.4.2.</span> <span class="nav-text">2ï¼‰è¿è¡Œæœºåˆ¶ï¼ˆæˆ‘çš„ç†è§£ï¼‰</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3ï¼‰ä»»åŠ¡é˜Ÿåˆ—åˆ†ç±»"><span class="nav-number">1.0.1.4.3.</span> <span class="nav-text">3ï¼‰ä»»åŠ¡é˜Ÿåˆ—åˆ†ç±»</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¸¾ä¸ªğŸŒ°ï¼Œé—®è¾“å‡ºé¡ºåº"><span class="nav-number">1.0.1.4.4.</span> <span class="nav-text">ä¸¾ä¸ªğŸŒ°ï¼Œé—®è¾“å‡ºé¡ºåº</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#æ„Ÿè§‰æ–‡å­—å¤ªå¤šå°±å˜å¥½å¥½å¤æ‚ï¼Œçœ‹å›¾"><span class="nav-number">1.0.1.4.5.</span> <span class="nav-text">æ„Ÿè§‰æ–‡å­—å¤ªå¤šå°±å˜å¥½å¥½å¤æ‚ï¼Œçœ‹å›¾</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç¬¬äºŒä¸ªğŸŒ°ï¼Œå…¶å®å†™åˆ°è¿™çš„æ—¶å€™ï¼Œæˆ‘è§‰å¾—æˆ‘å·²ç»å¯¹äº‹ä»¶å¾ªç¯äº†å¦‚æŒ‡æŒäº†ï¼Œç„¶é¹…æˆ‘åˆçœ‹åˆ°äº†è¿™æ ·çš„ä¸€é“é¢˜"><span class="nav-number">1.0.1.4.6.</span> <span class="nav-text">ç¬¬äºŒä¸ªğŸŒ°ï¼Œå…¶å®å†™åˆ°è¿™çš„æ—¶å€™ï¼Œæˆ‘è§‰å¾—æˆ‘å·²ç»å¯¹äº‹ä»¶å¾ªç¯äº†å¦‚æŒ‡æŒäº†ï¼Œç„¶é¹…æˆ‘åˆçœ‹åˆ°äº†è¿™æ ·çš„ä¸€é“é¢˜</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç¬¬ä¸‰ä¸ªğŸŒ°ï¼Œä¸€æ ·çš„ï¼Œå½“æˆ‘çœ‹å®Œè¿™é¢˜åæˆ‘è§‰å¾—æˆ‘åˆæ‡‚äº†ï¼Œç„¶åçœ‹ä¸‹ä¸€é¢˜"><span class="nav-number">1.0.1.4.7.</span> <span class="nav-text">ç¬¬ä¸‰ä¸ªğŸŒ°ï¼Œä¸€æ ·çš„ï¼Œå½“æˆ‘çœ‹å®Œè¿™é¢˜åæˆ‘è§‰å¾—æˆ‘åˆæ‡‚äº†ï¼Œç„¶åçœ‹ä¸‹ä¸€é¢˜</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ€»ç»“"><span class="nav-number">1.0.1.5.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ç§¦ç€šæ–‡</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
